import streamlit as st\nimport pandas as pd\nfrom rembg import remove\nfrom PIL import Image\nimport io\n\n# 1. Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØµÙØ­Ø©\nst.set_page_config(page_title=\"Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª - ØªØ®ØµÙŠØµ ÙƒØ§Ù…Ù„\", layout=\"wide\")\n\n# 2. ØªÙ‡ÙŠØ¦Ø© Ù…Ø®Ø²Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª\nif 'product_list' not in st.session_state:\n    st.session_state.product_list = []\nif 'columns' not in st.session_state:\n    # Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø§Ù„ØªÙŠ ÙŠÙ…ÙƒÙ†Ùƒ Ø­Ø°ÙÙ‡Ø§ Ø£Ùˆ ØªØºÙŠÙŠØ±Ù‡Ø§ Ù…Ù† Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©\n    st.session_state.columns = [\"Ø§Ù„Ø§Ø³Ù…\", \"Ø§Ù„Ø³Ø¹Ø±\", \"Ø§Ù„ÙØ¦Ø©\", \"Ø§Ù„ØµÙˆØ±Ø©\"]\nif 'temp_url' not in st.session_state:\n    st.session_state.temp_url = \"\"\n\nst.title(\"âš™ï¸ Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª (ØªØ­ÙƒÙ… ÙƒØ§Ù…Ù„ Ø¨Ø§Ù„Ø­Ù‚ÙˆÙ„)\")\n\n# --- Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯: Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø­Ù‚ÙˆÙ„ ---\nwith st.expander(\"ğŸ› ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø­Ù‚ÙˆÙ„ ÙˆØ§Ù„Ø£Ø¹Ù…Ø¯Ø© (Ø£Ø¶Ù/Ø§Ø­Ø°Ù/Ø¹Ø¯Ù„ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©)\"):\n    st.write(\"ØµÙ…Ù… Ø´ÙƒÙ„ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ù‡Ù†Ø§:\")\n    \n    # Ø¥Ø¶Ø§ÙØ© Ø­Ù‚Ù„ Ø¬Ø¯ÙŠØ¯\n    new_col = st.text_input(\"Ø§Ø³Ù… Ø§Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¬Ø¯ÙŠØ¯\")\n    if st.button(\"Ø¥Ø¶Ø§ÙØ© Ø­Ù‚Ù„\"):\n        if new_col and new_col not in st.session_state.columns:\n            st.session_state.columns.append(new_col)\n            st.rerun()\n            \n    # Ø¹Ø±Ø¶ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù…Ø¹ Ø®ÙŠØ§Ø± Ø§Ù„Ø­Ø°Ù\n    st.write(\"Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø­Ø§Ù„ÙŠØ©:\")\n    cols_to_delete = []\n    for c in st.session_state.columns:\n        c1, c2 = st.columns([4, 1])\n        c1.text(f\"ğŸ“ {c}\")\n        if c2.button(\"Ø­Ø°Ù\", key=f\"del_col_{c}\"):\n            st.session_state.columns.remove(c)\n            st.rerun()\n\nst.markdown(\"---\")\n\n# Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø£ÙˆÙ„: Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØµÙˆØ±Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)\nst.header(\"1. Ù…Ø¹Ø§Ù„Ø¬Ø© ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬\")\nuploaded_file = st.file_uploader(\"Ø§Ø®ØªØ± ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬...\", type=[\"jpg\", \"jpeg\", \"png\"])\nif uploaded_file:\n    if st.button(\"Ø­Ø°Ù Ø§Ù„Ø®Ù„ÙÙŠØ©\"):\n        with st.spinner(\"Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...\"):\n            img = remove(Image.open(uploaded_file))\n            st.session_state.temp_url = f\"https://img-host.com/img_{len(st.session_state.product_list)}.png\"\n            st.image(img, width=200)\n            st.success(\"ØªÙ…Øª Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©!\")\n\nst.markdown(\"---\")\n\n# Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø«Ø§Ù†ÙŠ: Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©\nst.header(\"2. Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬\")\nnew_entry = {}\n\n# ØªÙˆÙ„ÙŠØ¯ Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©\ngrid_cols = st.columns(len(st.session_state.columns) if st.session_state.columns else 1)\n\nfor i, col_name in enumerate(st.session_state.columns):\n    with grid_cols[i % len(grid_cols)]:\n        if \"Ø§Ù„Ø³Ø¹Ø±\" in col_name:\n            new_entry[col_name] = st.number_input(col_name, min_value=0, format=\"%d\", key=f\"input_{col_name}\")\n        elif \"Ø§Ù„ØµÙˆØ±Ø©\" in col_name:\n            new_entry[col_name] = st.text_input(col_name, value=st.session_state.temp_url, key=f\"input_{col_name}\")\n        else:\n            new_entry[col_name] = st.text_input(col_name, key=f\"input_{col_name}\")\n\nif st.button(\"â• Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©\"):\n    if any(new_entry.values()):\n        st.session_state.product_list.append(new_entry)\n        st.session_state.temp_url = \"\"\n        st.success(\"ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©!\")\n        st.rerun()\n        \nst.markdown(\"---\")\n\n# Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø«Ø§Ù„Ø«: Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ÙˆØ§Ù„ØªØµØ¯ÙŠØ±\nst.header(\"3. Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©\")\nif st.session_state.product_list:\n    df = pd.DataFrame(st.session_state.product_list)\n    \n    # Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªØ±ØªÙŠØ¨ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø­Ø³Ø¨ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…\n    df = df.reindex(columns=st.session_state.columns)\n    \n    edited_df = st.data_editor(\n        df, \n        num_rows=\"dynamic\",\n        use_container_width=True,\n        column_config={\n            \"Ø§Ù„Ø³Ø¹Ø±\": st.column_config.NumberColumn(format=\"%d\"),\n            \"Ø§Ù„ØµÙˆØ±Ø©\": st.column_config.LinkColumn()\n        }\n    )\n    \n    # Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ Ø£ÙŠ ØªØºÙŠÙŠØ±\n    st.session_state.product_list = edited_df.to_dict('records')\n    st.success(\"ØªÙ… Ø§Ù„Ø­ÙØ¸ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹!\")\n    \n    # ØªØµØ¯ÙŠØ± Excel\n    output = io.BytesIO()\n    with pd.ExcelWriter(output, engine='openpyxl') as writer:\n        edited_df.to_excel(writer, index=False)\n    st.download_button(\"ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Excel\", output.getvalue(), \"products.xlsx\")\nelse:\n    st.info(\"Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ÙØ§Ø±ØºØ©.\")